### Local bashrc file containing system-specific settings

########## Prompt ##########
# References: https://misc.flogisoft.com/bash/tip_colors_and_formatting
#             https://tldp.org/HOWTO/Bash-Prompt-HOWTO/bash-prompt-escape-sequences.html
if ! type -p starship &>/dev/null; then
  # git status in prompt
  test -e "${HOME}/.scripts/git-prompt.sh" && source "${HOME}/.scripts/git-prompt.sh"
  export GIT_PS1_SHOWDIRTYSTATE=1
  RESTORE='\[\e[0m\]'
  export PS1="\[\e[00;42;30m\][\w]${RESTORE}\[\e[33m\]\$(__git_ps1 \"[\[\e[03m\]%s\[\e[23m\]]\")${RESTORE} â¨• "
fi

########## Variables ##########
# macOS automatically adds all paths in /etc/paths.d

########## Alias ##########
alias typora="open -a typora"
alias dsclean='find . -type f -name .DS_Store -delete'

########## Miniconda ##########
# Activate environment:   conda activate <env>
# Deactivate environment: conda deactivate
if [ -f "/opt/conda/etc/profile.d/conda.sh" ]; then
    . "/opt/conda/etc/profile.d/conda.sh"
else
    export PATH="/opt/conda/condabin:$PATH"
fi

########## Completion ##########
# ble.sh ships its own completion scripts, no need to load again
if [[ -z ${BLE_VERSION-} ]]; then
  if [[ -d "${HOMEBREW_PREFIX}" ]] ; then
      if [[ -r "${HOMEBREW_PREFIX}/etc/profile.d/bash_completion.sh" ]]
      then
          source "${HOMEBREW_PREFIX}/etc/profile.d/bash_completion.sh"
      else
          for COMPLETION in "${HOMEBREW_PREFIX}/etc/bash_completion.d/"*
          do
              [[ -r "${COMPLETION}" ]] && source "${COMPLETION}"
          done
      fi
  fi
fi
