### Local bashrc file containing system-specific settings

# export TZ="America/Los_Angeles"

########## Prompt ##########
export GIT_PS1_SHOWDIRTYSTATE="" # chipyard is slow with this
RESTORE='\[\e[0m\]'
export PS1="\[\e[0;38;5;43m\][\[\e[1;38;5;43m\]\u\[\e[0;38;5;6m\]@\[\e[1;38;5;43m\]\h\[\e[0;38;5;43m\]]\[\e[1;38;5;6m\]\w\[\e[0;38;5;43m\]\[\e[33m\]\$(__git_ps1 \"[\[\e[03m\]%s\[\e[23m\]]\")${RESTORE}\[\e[1;38;5;43m\] $ ${RESTORE}"

########## Environment ##########
# The base env bin is added to PATH and will always be implicitly activated
# To activate/deactivate other environment, run the following commands
# Activate environment:   conda activate <env>
# Deactivate environment: cond deactivate
CONDA_HOME=${HOME}/.conda
. "${CONDA_HOME}/etc/profile.d/conda.sh"
[[ ":$PATH:" =~ ":${CONDA_HOME}/bin:" ]] || PATH="${CONDA_HOME}/bin:$PATH"
export INFOPATH="${CONDA_HOME}/share/info"
export PATH

########## pyenv ##########
# Put this after Conda base - higher priority than base env but lower priority than manually activated env 
if [ -d "$HOME/.pyenv" ]; then
  export PYENV_ROOT="$HOME/.pyenv"
  [[ -d $PYENV_ROOT/bin ]] && export PATH="$PYENV_ROOT/bin:$PATH"
  eval "$(pyenv init -)"
fi

########## Completion ##########
# zellij doesn't automatically source /etc/profile in new panes
# so manually source the system-wide completion scripts
source /etc/profile.d/bash_completion.sh

if [[ -r "${CONDA_HOME}/etc/profile.d/bash_completion.sh" ]]; then
    source "${CONDA_HOME}/etc/profile.d/bash_completion.sh"
else
    for COMPLETION in "${CONDA_HOME}/etc/bash_completion.d/"*; do
        [[ -r "${COMPLETION}" ]] && source "${COMPLETION}"
    done
fi

########## fzf ##########
# Auto-completion
source ${CONDA_HOME}/share/fzf/shell/completion.bash 2> /dev/null
# Key bindings
source ${CONDA_HOME}/share/fzf/shell/key-bindings.bash 2> /dev/null

########## wezterm ##########
# set alias if installed through flatpak
if ! command -v wezterm &> /dev/null && command -v flatpak run org.wezfurlong.wezterm &> /dev/null; then
  alias wezterm='flatpak run org.wezfurlong.wezterm'
fi


